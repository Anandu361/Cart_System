<!DOCTYPE html>
<html>
	<head>
		<title>Register</title>
	</head>
	<body>
		<div>
			<h2>Register</h2>
			<form id="registerForm">
			    <label>Username:</label>
			    <input type="text" id="username" required><br><br>

			    <label>Email:</label>
			    <input type="email" id="email" required><br><br>

			    <label>Password:</label>
			    <input type="password" id="password" required><br><br>

			    <button type="submit">Register</button>
				<p>Already a user? <a th:href="@{/login}">Login</a></p>
			</form>
			<p id="msg"></p>
		</div>
		<script>
		    document.getElementById("registerForm").addEventListener("submit", function(e) {
		        e.preventDefault();

		        const username = document.getElementById("username").value;
		        const email = document.getElementById("email").value;
		        const password = document.getElementById("password").value;

		        fetch("http://localhost:8080/api/auth/register", {
		            method: "POST",
		            headers: {
		                "Content-Type": "application/json"
		            },
		            body: JSON.stringify({
		                username: username,
		                email: email,
		                password: password
		            })
		        })
		        .then(res => res.text())
		        .then(data => {
		            document.getElementById("msg").innerText = data;

		            if (data.includes("Success")) {
		                window.location.href = "/login"; // âœ… redirect to login after register
		            }
		        });
		    });
		</script>
	</body>
</html>