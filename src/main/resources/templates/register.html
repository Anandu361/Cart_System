<!DOCTYPE html>
<html>
	<head>
		<title>Register</title>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
	</head>
	<body>
		<div class="container-fluid bg-primary">
			<div class="d-flex flex-coloumn justify-content-center align-items-center vh-100">
				<div class="card w-25 m-4 p-4">
					<div class="card-body">
						<h2 class="card-title text-center pb-2">Register</h2>
						<form id="registerForm">
						    <div class="mb-3">
								<label for="username" class="form-label">Username:</label>
							    <input type="text" class="form-control" id="username" required>
							</div>

							<div class="mb-3">
							  <label for="email" class="form-label">Email address</label>
							  <input type="email" class="form-control" id="email" required placeholder="name@example.com">
							</div>

						    <div class="mb-3">
								<label for="password" class="form-label">Password:</label>
							    <input type="password" class="form-control" id="password" required>
							</div>

							<div class="mx-auto d-flex p-2">
								<button type="submit" class="btn btn-primary mx-auto">Register</button>
							</div>
							<p class="text-center">Already a user? <a class="icon-link icon-link-hover" th:href="@{/login}">Login<svg xmlns="http://www.w3.org/2000/svg" class="bi" viewBox="0 0 16 16" aria-hidden="true"><path d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
							  </svg></a></p>
						</form>
						<p id="msg"></p>
					</div>
				</div>
			</div>
		</div>
		<script>
		    document.getElementById("registerForm").addEventListener("submit", function(e) {
		        e.preventDefault();

		        const username = document.getElementById("username").value;
		        const email = document.getElementById("email").value;
		        const password = document.getElementById("password").value;

		        fetch("http://localhost:8080/api/auth/register", {
		            method: "POST",
		            headers: {
		                "Content-Type": "application/json"
		            },
		            body: JSON.stringify({
		                username: username,
		                email: email,
		                password: password
		            })
		        })
		        .then(res => res.text())
		        .then(data => {
		            document.getElementById("msg").innerText = data;

		            if (data.includes("Success")) {
		                window.location.href = "/login"; // âœ… redirect to login after register
		            }
		        });
		    });
		</script>
	</body>
</html>