<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>Login</title>
	</head>
	<body>
		<div>
			<h2>Login</h2>
			<form id="loginForm">
			    <label>Email:</label>
			    <input type="email" id="email" required><br><br>

			    <label>Password:</label>
			    <input type="password" id="password" required><br><br>

			    <button type="submit">Login</button>
			</form>
			<p>New user? <a th:href="@{/register}">Register</a></p>
			<p id="msg"></p>
		</div>
		<script>
		    document.getElementById("loginForm").addEventListener("submit", function(e) {
		        e.preventDefault();

		        const email = document.getElementById("email").value;
		        const password = document.getElementById("password").value;

		        fetch("http://localhost:8080/api/auth/login", {
		            method: "POST",
		            headers: {
		                "Content-Type": "application/json"
		            },
		            body: JSON.stringify({
		                email: email,
		                password: password
		            })
		        })
		        .then(res => res.text())
		        .then(data => {
		            if (data && data.length > 20) {
		                localStorage.setItem("token", data);   // ✅ store JWT
		                window.location.href = "/home";       // ✅ redirect
		            } else {
		                document.getElementById("msg").innerText = data;
		            }
		        });
		    });
		</script>
	</body>
</html>